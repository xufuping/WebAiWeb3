---
title: ‰∏âÂàÜÈíüÂºÄÂèëÂâçÁ´ØÂ∫îÁî®
tags: [ÂâçÁ´Ø, ÊúçÂä°Á´Ø, Next, Node]
created: 2025-11-06 14:28:40
---

# ‰∏âÂàÜÈíüÂºÄÂèëÂâçÁ´ØÂ∫îÁî®

## üìå Ê†áÁ≠æ

- ÂâçÁ´Ø
- ÊúçÂä°Á´Ø
- Next
- Node

## üìù ÂÜÖÂÆπ
# ÂâçÁ´Ø

### ÂâçÁ´ØÊ°ÜÊû∂ÔºöNext.js(version 14)

Next.js Ê°ÜÊû∂ÊúÄÂ§ßÁöÑ‰ºòÁÇπ‰πã‰∏ÄÊòØÂÖ∂ÊîØÊåÅÊúçÂä°Âô®Ê∏≤ÊüìÂíåÈùôÊÄÅÁîüÊàê„ÄÇ‰º†ÁªüÁöÑÂâçÁ´ØÂ∫îÁî®Á®ãÂ∫èÈÄöÂ∏∏Â∞ÜÊ∏≤ÊüìÂ∑•‰Ωú‰∫§ÁªôÂÆ¢Êà∑Á´ØÔºåËøô‰ºöÂØºËá¥È¶ñÂ±èÂä†ËΩΩÊó∂Èó¥ËæÉÈïøÔºåÂπ∂‰∏îÂØπÊêúÁ¥¢ÂºïÊìéÁöÑÂèãÂ•ΩÊÄß‰∏ç‰Ω≥„ÄÇËÄå Next.js Ê°ÜÊû∂ÈÄöËøáÂú®ÊúçÂä°Âô®Á´ØËøõË°åÊ∏≤ÊüìÔºåËÉΩÂ§üÁîüÊàêÂÆåÊï¥ÁöÑ HTML ÂÜÖÂÆπÔºåÂπ∂Â∞ÜÂÖ∂Áõ¥Êé•ÂèëÈÄÅÁªôÊµèËßàÂô®Ôºå‰ªéËÄåÂ§ßÂ§ßÊèêÈ´òÈ°µÈù¢ÁöÑÂä†ËΩΩÈÄüÂ∫¶ÂíåÊÄßËÉΩ„ÄÇ

##### ÂàùÂßãÂåñÈ°πÁõÆ

```javascript
1.ÂàõÂª∫È°πÁõÆ
npx create-next-app@latest --typescript

2.ÂÆâË£Ö‰æùËµñ
yarn install

3.ÂêØÂä®È°πÁõÆ
yarn run dev
```

### UI ÁªÑ‰ª∂Â∫ì Antd + ÂÆöÂà∂ÂåñÊ†∑Âºè Tailwindcss

Antd ÊòØ‰∏Ä‰∏™‰ºÅ‰∏öÁ∫ß UI ÁªÑ‰ª∂Â∫ìÔºåÂÆÉÂåÖÂê´‰∏∞ÂØåÁöÑÁªÑ‰ª∂ÂíåÊ†∑ÂºèÔºåÂπ∂‰∏îÊòì‰∫éÂÆöÂà∂ÂíåÊâ©Â±ï„ÄÇTailwindcss ÊòØ‰∏Ä‰∏™ CSS Ê°ÜÊû∂ÔºåÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁªÑÈ¢ÑÂÆö‰πâÁöÑÊ†∑ÂºèÁ±ªÔºåÂèØ‰ª•Êñπ‰æøÂú∞Â∫îÁî®‰∫éÁªÑ‰ª∂ÂíåÈ°µÈù¢‰∏≠„ÄÇÈÄöËøáÁªìÂêà‰ΩøÁî® Antd Âíå TailwindcssÔºåÂèØ‰ª•ÂÆûÁé∞‰∏Ä‰∏™ÂÖ∑Êúâ‰∏∞ÂØåÁªÑ‰ª∂ÂíåÊ†∑Âºè„ÄÅÊòì‰∫éÂÆöÂà∂ÂíåÊâ©Â±ïÁöÑÂâçÁ´ØÂ∫îÁî®Á®ãÂ∫è„ÄÇ

##### 1.ÂºïÂÖ• UI ÁªÑ‰ª∂Â∫ì

1.ÂàõÂª∫È°πÁõÆ

```javascript
yarn add antd
```

2.ÊîπÂÜô pages/\_document.tsx

```javascript
import React from "react";
import { createCache, extractStyle, StyleProvider } from "@ant-design/cssinjs";
import Document, { Head, Html, Main, NextScript } from "next/document";
import type { DocumentContext } from "next/document";
const MyDocument = () => (
  <Html lang="en">
    <Head />
    <body>
      <Main />
      <NextScript />
    </body>
  </Html>
);
MyDocument.getInitialProps = async (ctx: DocumentContext) => {
  const cache = createCache();
  const originalRenderPage = ctx.renderPage;
  ctx.renderPage = () =>
    originalRenderPage({
      enhanceApp: (App) => (props) =>
        (
          <StyleProvider cache={cache}>
            <App {...props} />
          </StyleProvider>
        ),
    });
  const initialProps = await Document.getInitialProps(ctx);
  const style = extractStyle(cache, true);
  return {
    ...initialProps,
    styles: (
      <>
        {initialProps.styles}
        <style dangerouslySetInnerHTML={{ __html: style }} />
      </>
    ),
  };
};
export default MyDocument;
```

3.ÂºïÂÖ• Tailwindcss
Âú®ÂàùÂßãÂåñÈ°πÁõÆÊó∂,ÂãæÈÄâ‰ΩøÁî® Tailwindcss,Âç≥ÂèØÂÆåÊàê‰æùËµñÂåÖÁöÑÂºïÂÖ•ÂíåÈÖçÁΩÆ:
![alt text](https://ucarecdn.com/eb92b701-3d89-473c-85fd-a4f63e491613/useTailwindcss.png)



### Êï∞ÊçÆÈÄö‰ø°ÔºöGraphQL + Apollo

GraphQL ÊòØ‰∏ÄÁßçÈ´òÊïà„ÄÅÁÅµÊ¥ªÁöÑ API Êü•ËØ¢ËØ≠Ë®ÄÔºåÂÆÉÂÖÅËÆ∏ÂÆ¢Êà∑Á´ØÁ≤æÁ°ÆËØ∑Ê±ÇÊâÄÈúÄÊï∞ÊçÆÔºåÈÄöËøáÂçï‰∏ÄÁ´ØÁÇπËÆøÈóÆÊâÄÊúâÊï∞ÊçÆÔºåÊîØÊåÅÂÆûÊó∂Êõ¥Êñ∞ÂíåËÆ¢ÈòÖÔºå‰ª•ÂèäÊã•ÊúâÂº∫Á±ªÂûãÁ≥ªÁªüÔºåÁÆÄÂåñ‰∫ÜÊï∞ÊçÆÁÆ°ÁêÜÂíåÊèêÈ´ò‰∫ÜÂ∫îÁî®Á®ãÂ∫èÁöÑÊÄßËÉΩÂíåÂèØÁª¥Êä§ÊÄß„ÄÇ

Apollo GraphQL ÊòØ‰∏Ä‰∏™Âº∫Â§ßÁöÑ GraphQL ÂÆ¢Êà∑Á´ØÂ∫ìÔºåÂÆÉÊèê‰æõ‰∫ÜÂØπ GraphQL ÊúçÂä°ÁöÑÈ´òÊïà„ÄÅÂÆâÂÖ®ËÆøÈóÆÔºåÊîØÊåÅËá™Âä®ÂàÜÈ°µ„ÄÅÁºìÂ≠ò„ÄÅÊåÅ‰πÖÂåñÂ≠òÂÇ®„ÄÅÈîôËØØÂ§ÑÁêÜÂíåÊõ¥Â§öÈ´òÁ∫ßÂäüËÉΩÔºå‰ΩøÂæóÂºÄÂèëÂ§çÊùÇÁöÑ„ÄÅÂÆûÊó∂Êõ¥Êñ∞ÁöÑÂ∫îÁî®Á®ãÂ∫èÂèòÂæóÊõ¥Âä†ÁÆÄÂçïÂíåÈ´òÊïà„ÄÇ

1.ÂºïÂÖ• GraphQL + Apollo

```javascript
yarn add @apollo/client graphql graphql-tag
```

2.ÂàõÂª∫Âπ∂‰ΩøÁî® GraphQL ÊúçÂä°ÁöÑ Provider

```javascript
// 1.ÊûÑÂª∫Provider
import { ReactElement } from "react";
import fetch from "isomorphic-unfetch";
import {
  ApolloClient,
  InMemoryCache,
  ApolloProvider,
  ApolloLink,
  HttpLink,
} from "@apollo/client";
const httpLink = new HttpLink({
  fetch,
  uri: "http://localhost:4000/graphql", // GraphQLÊúçÂä°Á´ØÂú∞ÂùÄ
});
export const ApolloInfoProvider = ({
  children,
}: {
  children: ReactElement,
}) => {
  const client = new ApolloClient({
    link: httpLink,
    cache: new InMemoryCache(),
  });
  return <ApolloProvider client={client}>{children}</ApolloProvider>;
};

// 2.‰ΩøÁî®Provider
import { ApolloInfoProvider } from "@/contexts";
import { Users } from "./Users";
export default function Home() {
  return (
    <ApolloInfoProvider>
      <Users />
    </ApolloInfoProvider>
  );
}
```

3.ÂàõÂª∫ GraphQL Êü•ËØ¢,Â¶Ç‰∏ãÊü•ËØ¢Áî®Êà∑ÂíåÂàõÂª∫Áî®Êà∑ÁöÑÁ§∫‰æã

```javascript
import gql from "graphql-tag";
// 1.ÂàõÂª∫Êü•ËØ¢Êé•Âè£
export const GET_USERS = gql`
  {
    users {
      id
      name
      email
      password
    }
  }
`;

// 2.ÂàõÂª∫ÁºñËæëÊé•Âè£
export const CREATE_USER = gql`
  mutation createUser($userInput: UserInput) {
    createUser(userInput: $userInput) {
      createdAt
      email
      id
      name
      password
      updatedAt
    }
  }
`;
```

4.Ë∞ÉÁî® GraphQL Êé•Âè£

```javascript
import { useQuery, useMutation } from "@apollo/client";
import { GET_USERS, CREATE_USER } from "api";

const User = () => {
  // 1.Ë∞ÉÁî®Êü•ËØ¢Êé•Âè£
  const { loading, data: info, refetch } = useQuery(GET_USERS);
  // 2.Ëé∑ÂèñÁºñËæëÊé•Âè£
  const [CREATE_USER] = useMutation(CREATE_USER);
  // 3.ÂàõÂª∫Áî®Êà∑
  const createUser = useCallback(async () => {
    try {
      await createUser({
        variables: {
          userInput: {
            name: "John Doe",
            email: "johndoe@example.com",
            password: "password",
          },
        },
      });
      // Âà∑Êñ∞Êï∞ÊçÆ
      refetch();
    } catch (error) {
      console.error(error);
    }
  }, [createUser, form, handleFinish]);

  return (
    <div className="w-full h-full p-4 gap-2 flex flex-col">
      <div>
        <Button type="primary" onClick={createUserHandle}>
          Create User
        </Button>
      </div>
      <Form form={form} component={false}>
        <Table
          loading={loading}
          className="w-full"
          bordered
          dataSource={data}
          rowClassName="editable-row"
          pagination={false}
          scroll={{ y: "80vh" }}
        />
      </Form>
    </div>
  );
};
```
Á§∫‰æãÂ¶Ç‰∏ãÔºö
![alt text](https://ucarecdn.com/bd9ec03b-2d48-4d69-ad1d-e38c12112f73/createUser.png)

# ÂêéÁ´Ø

### ÂêéÁ´ØÊ°ÜÊû∂ÔºöTS + Express
Express.jsÊòØ‰∏Ä‰∏™ËΩªÈáèÁ∫ß„ÄÅÁÅµÊ¥ªÁöÑNode.js webÂ∫îÁî®Ê°ÜÊû∂ÔºåÂÆÉÊèê‰æõ‰∫ÜÂø´ÈÄüË∑ØÁî±„ÄÅ‰∏≠Èó¥‰ª∂ÊîØÊåÅ„ÄÅÊ®°ÊùøÂºïÊìéÈõÜÊàêÁ≠âÂäüËÉΩÔºå‰ΩøÂæóÂºÄÂèëRESTful APIÂíåwebÂ∫îÁî®Á®ãÂ∫èÂèòÂæóÁÆÄÂçïÂø´Êç∑ÔºåÂêåÊó∂Êã•ÊúâÂº∫Â§ßÁöÑÁîüÊÄÅÁ≥ªÁªüÂíåÁ§æÂå∫ÊîØÊåÅ„ÄÇ

1.ÂºïÂÖ• Express
```javascript
yarn add express
```

2.ÂàõÂª∫ Express Â∫îÁî®
```javascript
import express from "express";

const startServer = async () => {
  const app = express();
  app.listen(4000, () => {
    console.log("Server is now running on http://localhost:4000");
  });
};
startServer();
```

### Êï∞ÊçÆÁÆ°ÁêÜÔºöPostgresSQL + Flyway + Sequelize
FlywayÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑÊï∞ÊçÆÂ∫ìËøÅÁßªÂ∑•ÂÖ∑ÔºåÂÆÉ‰ª•SQLËÑöÊú¨ÁöÑÂΩ¢ÂºèÁÆ°ÁêÜÊï∞ÊçÆÂ∫ìÁâàÊú¨ÊéßÂà∂ÔºåÊîØÊåÅÂ§öÁßçÊï∞ÊçÆÂ∫ìÂπ≥Âè∞ÔºåÊèê‰æõ‰∫ÜËá™Âä®ÂåñÈÉ®ÁΩ≤„ÄÅÂõûÊªöËÉΩÂäõ„ÄÅÁâàÊú¨ÊéßÂà∂ÂíåÊä•ÂëäÁ≠âÂäüËÉΩÔºå‰ΩøÂæóÊï∞ÊçÆÂ∫ìËøÅÁßªËøáÁ®ãÊõ¥Âä†ÂèØÊéß„ÄÅÂèØËøΩË∏™ÂíåÈ´òÊïà„ÄÇ

SequelizeÊòØ‰∏Ä‰∏™Âü∫‰∫éPromiseÁöÑNode.js ORMÔºàÂØπË±°ÂÖ≥Á≥ªÊò†Â∞ÑÔºâÂ∫ìÔºåÂÆÉÊîØÊåÅPostgreSQL„ÄÅMySQL„ÄÅMariaDB„ÄÅSQLiteÂíåMSSQLÁ≠âÂ§öÁßçÊï∞ÊçÆÂ∫ìÔºåÊèê‰æõ‰∫ÜÊ®°ÂûãÂÆö‰πâ„ÄÅÂÖ≥Á≥ªËÆæÁΩÆ„ÄÅ‰∫ãÂä°ÁÆ°ÁêÜÁ≠âÂäüËÉΩÔºå‰ΩøÂæóÂú®Node.jsÁéØÂ¢É‰∏ãËøõË°åÂ§çÊùÇÊï∞ÊçÆÂ∫ìÊìç‰ΩúÊõ¥Âä†Áõ¥ËßÇÂíåÈ´òÊïà„ÄÇ

##### ‰∏Ä„ÄÅ‰ΩøÁî®FlywayÁÆ°ÁêÜÊï∞ÊçÆÂ∫ìÁâàÊú¨

1.ÂºïÂÖ• node-flyway
```javascript
yarn add node-flyway
```

2.ÂàõÂª∫Êï∞ÊçÆÂ∫ìË°®sqlËÑöÊú¨
```sql
CREATE TABLE client_users (
    id VARCHAR(255) PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL,
    status VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);
```

3.ÂàõÂª∫ migrate ËÑöÊú¨
```javascript
const { Flyway } = require('node-flyway');
const flyway = new Flyway(
    {
        url:"jdbc:postgresql://localhost:5432/base_full_stack",
        user:"postgres",
        password:"password",
        defaultSchema: "public",
        // sqlËÑöÊú¨Ë∑ØÂæÑ
        migrationLocations: ["src/db/migrations/sql"]
    }
);
flyway.migrate().then((response) => {
    if(!response.success) {
      throw new Error(`Unable to execute migrate command.`, response);
    }
    else {
      console.log(`Successfully executed migrate command:`,response)
    }
});
```

4.ÊâßË°å migrate ËÑöÊú¨
```javascript
// package.json
"scripts": {
    "migration": "node ./src/db/migrations/index.js",
  },
```

##### ‰∫å„ÄÅ‰ΩøÁî®SequelizeËøûÊé•ÂíåÊìç‰ΩúÊï∞ÊçÆÂ∫ì

1.ÂºïÂÖ• sequelize
```javascript
yarn add sequelize @types/sequelize
```

2.ÂàõÂª∫Êï∞ÊçÆÂ∫ìË°®ÁªìÊûÑÂÆû‰æã
```javascript
import { DataTypes } from "sequelize";
export const defineClientUsers = (sequelize) => {
  const clientUsers = sequelize.define(
    "clientUsers",
    {
      id: {
        type: DataTypes.STRING,
        primaryKey: true,
        defaultValue: DataTypes.UUIDV4,
      },
      name: {
        type: DataTypes.STRING,
        allowNull: false,
      },
      createdAt: {
        type: DataTypes.DATE,
        allowNull: false,
      },
      updatedAt: {
        type: DataTypes.DATE,
        allowNull: false,
      },
    },
    {
      tableName: "client_users",
      underscored: true,
    }
  );
  return clientUsers;
};

// ÂºïÂÖ•ÂÆû‰æã
export class SequelizeDb {
  constructor() {
    const sequelize = new Sequelize(DATA_BASE_URI);
    this.sequelize = sequelize;
    this.Sequelize = Sequelize;
    this.ClientUsers = defineClientUsers(sequelize);
  }
}
```

3.ÂàõÂª∫Êï∞ÊçÆÂ∫ìË°® modal ÂÆû‰æã
```javascript
import { DATA_STATUS } from "../../constants";

export type User = {
  id: string;
  name: string;
  email: string;
  password: string;
  createdAt: Date;
  updatedAt: Date;
};
export type UserInputData = {
  name: string;
  email: string;
  password: string;
};

export class ClientUsers {
  constructor(sequelizeDb) {
    this.sequelizeDb = sequelizeDb;
  }
  async findOneById(id: string) {
    try {
      const user = await this.sequelizeDb.ClientUsers.findOne({
        where: {
          id,
          status: DATA_STATUS.available,
        },
      });
      if (user) {
        let final = user.toJSON();
        return final;
      }
    } catch (error) {
      console.log("error:", error);
    }
  }
  // ÂàõÂª∫Áî®Êà∑
  async create(data: UserInputData) {
    try {
      const info = {
        name: data.name,
        email: data.email,
        password: data.password,
        status: DATA_STATUS.available,
      };
      const newUser = await this.sequelizeDb.ClientUsers.create(info);

      return this.findOneById(newUser.id);
    } catch (error) {
      console.log("error:", error);
    }
  }
}

// ÂºïÂÖ•ÂÆû‰æã
export class Models {
  constructor(sequelizeDb) {
    this.sequelizeDb = sequelizeDb;
    this.clientUsers = new ClientUsers(sequelizeDb);
  }
}
```

4.ÂàõÂª∫Êï∞ÊçÆÂ∫ìÊìç‰ΩúÂáΩÊï∞
```javascript
import { Models } from "./models";
import { SequelizeDb } from "./sequelize-db";

const instances = {};

// Ëé∑ÂèñÊï∞ÊçÆÂ∫ì‰ø°ÊÅØ
export async function getDb(instanceAlias = "default") {
  const instancePromise = instances[instanceAlias];
  if (!instancePromise) {
    throw new Error("db instance must be created first");
  }
  const { models, sequelizeDb } = await instancePromise;
  return { models, sequelizeDb };
}

// ÂàùÂßãÂåñÊï∞ÊçÆÂ∫ìËøûÊé•
async function initDb() {
  const sequelizeDb = new SequelizeDb();
  const models = new Models(sequelizeDb);
  return { models, sequelizeDb };
}

// Ê£ÄÊµãÊï∞ÊçÆÂ∫ìÊòØÂê¶Â∑≤ËøûÊé•
export function makeDb(instanceAlias = "default") {
  if (instances[instanceAlias]) {
    throw new Error(`db instance ${instanceAlias} already made`);
  }
  const dbPromise = initDb();
  instances[instanceAlias] = dbPromise;
  return true;
}
```

### Êï∞ÊçÆÈÄö‰ø°ÔºöGraphQL + Apollo

1.ÂºïÂÖ• GraphQL + Apollo
```javascript
yarn add apollo-server apollo-server-express
```

2.ÂàõÂª∫ schema, Áî®‰∫éÂÆö‰πâÊé•Âè£ÁöÑÊï∞ÊçÆÁªìÊûÑ
```javascript
import { gql } from "apollo-server-express";

export const typeDefs = gql`
  type Query {
    users: [User!]!
  }
  type Mutation {
    createUser(userInput: UserInput): User!
    updateUser(userId: String!, updateUser: UserInput): User!
    deleteUser(userId: String!): Boolean!
  }
  type User {
    id: String!
    email: String!
    name: String!
    password: String
    createdAt: String!
    updatedAt: String!
  }
  input UserInput {
    email: String!
    name: String!
    password: String!
  }
`;
```

3.ÂàõÂª∫ resolvers, Áî®‰∫éÂìçÂ∫îËØ∑Ê±Ç
```javascript
import { UserInputData } from "src/db/models/clientUsers";

// Êü•ËØ¢Êé•Âè£
const UserQueries = {
  users: async (_, args, { models }) => {
    try {
      const users = await models.clientUsers.findAll();
      return users;
    } catch (err) {
      throw err;
    }
  },
};

// ‰øÆÊîπÊé•Âè£
const UserMutation = {
  createUser: async (
    _,
    { userInput }: { userInput: UserInputData },
    { models }
  ) => {
    try {
      const user = await models.clientUsers.create(userInput);
      return user;
    } catch (error) {
      throw error;
    }
  }
};

// ÂêàÂπ∂ resolvers
const rootResolver = {
  Query: {
    ...UserQueries
  },
  Mutation: {
    ...UserMutation
  }
};
```

4.Â∫îÁî® GraphQL
```javascript
import { ApolloServer } from "apollo-server-express";
import express from "express";
import { getGraphqlInfo } from './graphql'

export const makeApp = async(models) => {
  const app = express();

  // ÂÆû‰æãÂåñ GraphQL
  const graphqlInfo = getGraphqlInfo(models);
  const server: ApolloServer = new ApolloServer(graphqlInfo);
  app.use(function (req: any, _, next) {
    req.models = models;
    next();
  });
  await server.start();
  server.applyMiddleware({ app });

  return app;
};
```
Á§∫‰æãÂ¶Ç‰∏ã:
![alt text](https://ucarecdn.com/672d9630-c19b-4eb3-9c48-75181fc88561/createUserGraph.png)


### ÂÆåÊï¥DemoËøûÊé•Â¶Ç‰∏ãÔºö
[https://github.com/xufuping/base-full-stack](https://github.com/xufuping/base-full-stack)